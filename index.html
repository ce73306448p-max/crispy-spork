<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>EcoNarrative — 문제·해결·상품 흐름형 웹앱</title>

<!-- font -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<!-- jsPDF for PDF export -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<!-- Chart.js for simple metrics -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
  :root{
    --bg:#f6fbfb; --card:#ffffff; --accent:#0b6b63; --muted:#55606a; --accent-2:#1f9d8a;
    --glass: rgba(255,255,255,0.85);
    --maxw:1100px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font-family:'Inter',system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background:linear-gradient(180deg,#f6fbfb,#eef7f5);
    color:#0f1720;
    -webkit-font-smoothing:antialiased;
  }

  /* Top nav */
  header{
    position:sticky; top:0; z-index:80;
    background:linear-gradient(90deg,var(--glass), rgba(255,255,255,0.75));
    backdrop-filter:blur(6px);
    border-bottom:1px solid rgba(10,20,15,0.03);
    padding:14px 18px;
  }
  .nav-inner{max-width:var(--maxw);margin:0 auto;display:flex;align-items:center;gap:12px}
  .logo{font-weight:700;color:var(--accent);letter-spacing:0.2px}
  nav{margin-left:auto;display:flex;gap:8px}
  nav button{background:transparent;border:none;padding:8px 10px;border-radius:8px;color:var(--muted);cursor:pointer}
  nav button:hover{background:rgba(10,20,15,0.03);color:var(--accent)}

  main{max-width:var(--maxw);margin:22px auto;padding:0 18px;display:grid;gap:18px}

  /* Sections */
  section.card{background:var(--card);border-radius:12px;padding:18px;box-shadow:0 8px 30px rgba(2,6,23,0.05);}
  h1,h2{margin:0;color:var(--accent)}
  h1{font-size:1.2rem}
  h2{font-size:1.05rem;margin-bottom:8px}
  p.lead{margin:6px 0 0 0;color:var(--muted);font-size:0.95rem;line-height:1.45}

  /* flow steps */
  .steps{display:grid;gap:10px}
  .step{display:flex;gap:12px;align-items:flex-start}
  .step .num{width:46px;height:46px;border-radius:999px;background:linear-gradient(180deg,var(--accent),var(--accent-2));color:white;display:flex;align-items:center;justify-content:center;font-weight:700}
  .step .body{flex:1}
  .step .body strong{display:block;color:#0e3f36}

  /* idea cards */
  .idea-grid{display:grid;gap:10px;grid-template-columns:1fr}
  @media(min-width:900px){ .idea-grid{grid-template-columns:1fr 1fr} }

  /* product grid */
  .product-grid{display:grid;gap:12px;grid-template-columns:1fr}
  @media(min-width:900px){ .product-grid{grid-template-columns:1fr 320px} }

  .product{display:flex;flex-direction:column;gap:8px;padding:12px;border-radius:10px;border:1px solid rgba(0,0,0,0.04)}
  .price{font-weight:700;color:var(--accent-2)}
  .btn{background:var(--accent);color:white;border:none;padding:8px 12px;border-radius:10px;cursor:pointer}
  .btn.ghost{background:transparent;border:1px solid rgba(0,0,0,0.06);color:var(--accent)}

  /* layout helpers */
  .row{display:flex;gap:8px;align-items:center}
  .right{margin-left:auto}
  .muted{color:var(--muted);font-size:.92rem}
  textarea,input,select{width:100%;padding:8px;border-radius:8px;border:1px solid rgba(0,0,0,0.06);font-size:.95rem}
  .small{font-size:.88rem;color:var(--muted)}

  footer{max-width:var(--maxw);margin:10px auto 40px auto;padding:12px 18px;color:var(--muted);text-align:center}
  .note{font-size:.88rem;color:var(--muted)}
  /* subtle anchor highlight for flow */
  .flow-nav{display:flex;gap:8px;margin-top:12px}
  .flow-nav button{padding:8px 10px;border-radius:8px;border:1px solid rgba(0,0,0,0.04);background:transparent;cursor:pointer}
</style>
</head>
<body>

<header>
  <div class="nav-inner">
    <div class="logo">EcoNarrative</div>
    <div class="muted" style="margin-left:12px">문예창작 전공 관점 — 문제 → 해결 아이디어 → 실무화(상품)</div>
    <nav>
      <button onclick="scrollToId('problems')">핵심 과제</button>
      <button onclick="scrollToId('solutions')">해결 아이디어</button>
      <button onclick="scrollToId('market')">상품(데모)</button>
    </nav>
  </div>
</header>

<main>

  <!-- Hero / Flow intro -->
  <section class="card" aria-labelledby="introTitle">
    <h1 id="introTitle">정확한 흐름: 과제 → 아이디어 → 상품</h1>
    <p class="lead">이 페이지는 문예창작 전공자의 관점에서 생태·환경·기후 문제의 핵심 과제를 분석하고, 그 과제를 해결하기 위한 창작 기반 사업 모델(디지털 콘텐츠·워크숍·라이선스)을 제시하며, 제안된 아이디어를 즉시 시험해볼 수 있는 상품(데모)으로 자연스럽게 연결합니다.</p>

    <div class="flow-nav">
      <button onclick="scrollToId('problems')">1) 핵심 과제 보기</button>
      <button onclick="scrollToId('solutions')">2) 해결 아이디어 보기</button>
      <button onclick="scrollToId('market')">3) 상품 데모 보기</button>
    </div>
  </section>

  <!-- 1. Problems -->
  <section id="problems" class="card" aria-labelledby="problemsTitle">
    <h2 id="problemsTitle">1. 핵심 과제 (문예창작 관점)</h2>
    <p class="lead">아래 항목은 '문예창작' 전공자가 기후·생태 문제를 다룰 때 직면하는 주요 과제들입니다. (간결·분석적 정리)</p>

    <div class="steps" style="margin-top:12px">
      <div class="step">
        <div class="num">P1</div>
        <div class="body">
          <strong>감각의 불연속성 — 독자와 현장의 거리</strong>
          <div class="small">도시화·디지털 매체 확산으로 독자가 자연 현상과 직접 연결되는 감각 경험이 감소. 결과적으로 기후 문제의 문화적 공감 형성이 약함.</div>
        </div>
      </div>

      <div class="step">
        <div class="num">P2</div>
        <div class="body">
          <strong>서사의 일반화 — 지역성 상실</strong>
          <div class="small">기후담론은 종종 거대 담론(통계·정책)으로 환원되어 지역적, 미시적 서사를 잃음. 독특한 로컬 내러티브 부재가 시장성 약화로 연결.</div>
        </div>
      </div>

      <div class="step">
        <div class="num">P3</div>
        <div class="body">
          <strong>상업화의 딜레마 — 메시지 VS 소비성</strong>
          <div class="small">환경 메시지의 순수성과 상업적 포장 사이의 긴장. 감성적 진정성과 상품 경쟁력을 동시에 확보하기 어려움.</div>
        </div>
      </div>

      <div class="step">
        <div class="num">P4</div>
        <div class="body">
          <strong>공동창작·저작권 문제</strong>
          <div class="small">현장 리서치·공동 수집 텍스트(파운드 텍스트 등)의 저작권·수익 분배 규칙 부재.</div>
        </div>
      </div>
    </div>

    <div style="display:flex;gap:8px;margin-top:14px">
      <button class="btn" onclick="scrollToId('solutions')">이 과제들을 어떻게 해결할까?</button>
      <button class="btn ghost" onclick="highlightProblems()">핵심만 한 문장 요약</button>
      <div class="right small muted" id="summaryBox"></div>
    </div>
  </section>

  <!-- 2. Solutions -->
  <section id="solutions" class="card" aria-labelledby="solutionsTitle">
    <h2 id="solutionsTitle">2. 해결 아이디어 (문예창작 기반·상업화 가능)</h2>
    <p class="lead">각 핵심 과제에 대응하는 구체적이고 상업화 가능한 제안을 제시합니다. 각 아이디어는 상품(서비스) 형태로 전환될 수 있도록 설계되었습니다.</p>

    <div class="idea-grid" style="margin-top:12px">
      <div class="product">
        <strong>A. 지역 감각 회복 키트 — '현장 리서치 패키지'</strong>
        <div class="small">문예창작 워크북 + 오디오 가이드 + 현장 관찰 미션(모바일용). 참가자가 로컬 감각을 복원하여 고유한 텍스트를 생성하도록 구성. 기업·학교에 B2B 패키지로 판매 가능.</div>
        <div class="small" style="margin-top:8px"><strong>문제 해결</strong>: P1(감각 불연속성) / P2(지역성 결핍)</div>
      </div>

      <div class="product">
        <strong>B. 마이크로 Zine 플랫폼 — 'Local Eco Zine'</strong>
        <div class="small">지역별 단행본(전자책/PDF) 시리즈 제작·판매 플랫폼. 조각 글(짧은 에세이/시)들을 큐레이션하여 구독자에게 월간 발행. 판매·구독 수익화 구조를 포함.</div>
        <div class="small" style="margin-top:8px"><strong>문제 해결</strong>: P2 / P3 (상업화 딜레마 해소: 구독 모델)</div>
      </div>

      <div class="product">
        <strong>C. 커미션·라이선스 스튜디오 — 'EcoStory Studio'</strong>
        <div class="small">기업/NGO 대상으로 로컬 서사 기반 콘텐츠 제작(브랜디드 스토리텔링) 및 저작권 기반 라이선스 판매. 맞춤형 에세이·동영상 스크립트 등 제공.</div>
        <div class="small" style="margin-top:8px"><strong>문제 해결</strong>: P3 / P4 (수익·라이선스 구조 제공)</div>
      </div>

      <div class="product">
        <strong>D. 공동창작 라이선스 도구 — 'Co-Authorship Manager'</strong>
        <div class="small">현장 문장(파운드 텍스트) 수집·버전 관리·저작권 태깅 기능 제공. 수익 분배 규칙을 계약 템플릿으로 자동 생성.</div>
        <div class="small" style="margin-top:8px"><strong>문제 해결</strong>: P4 (저작권·분배 문제 해결)</div>
      </div>
    </div>

    <div style="display:flex;gap:8px;margin-top:14px">
      <button class="btn" onclick="scrollToId('market')">이 아이디어를 상품으로 보기</button>
      <button class="btn ghost" onclick="downloadIdeaSummary()">아이디어 요약 다운로드</button>
    </div>
  </section>

  <!-- 3. Market / Product Demo -->
  <section id="market" class="card" aria-labelledby="marketTitle">
    <h2 id="marketTitle">3. 상품 데모 — 아이디어의 실현(시연·구매 시뮬레이션)</h2>
    <p class="lead">위 해결 아이디어를 실제 상품으로 전환한 데모입니다. 각 상품은 페이지 내에서 즉시 '구매(시뮬레이션)', '미리보기(PDF 생성)'가 가능합니다.</p>

    <div style="margin-top:12px" class="product-grid">
      <!-- Left: product list -->
      <div>
        <div class="product" id="prodA">
          <strong>지역 감각 회복 키트 (현장 패키지)</strong>
          <div class="small">오디오 가이드 + 워크북 PDF + 관찰 미션 템플릿. B2B/교수자용 패키지.</div>
          <div class="price">가격: 25,000원 (디지털)</div>
          <div class="row">
            <button class="btn" onclick="purchase('kit','지역 감각 회복 키트',25000)">구매(시뮬레이션)</button>
            <button class="btn ghost" onclick="previewPDF('지역 감각 회복 키트','현장 가이드 및 워크북\n\n샘플 콘텐츠...')">PDF 미리보기</button>
          </div>
        </div>

        <div class="product" style="margin-top:10px" id="prodB">
          <strong>Local Eco Zine — 연간 구독</strong>
          <div class="small">매달 지역 테마 전자 zine(시/에세이/짧은 다큐 콘텐츠) 제공. 구독자 전용 아카이브 접근.</div>
          <div class="price">가격: 월 4,000원</div>
          <div class="row">
            <button class="btn" onclick="subscribe('zine','Local Eco Zine',4000)">구독(시뮬레이션)</button>
            <button class="btn ghost" onclick="previewPDF('Local Eco Zine 샘플','목차\n1. 지역의 봄\n2. 빗소리 기록\n...')">샘플 보기</button>
          </div>
        </div>

        <div class="product" style="margin-top:10px" id="prodC">
          <strong>EcoStory Studio — 커미션 기본 패키지</strong>
          <div class="small">기업/지자체 대상 콘텐츠 제작 (단편 에세이 / 캠페인 카피) — 기본 요금에 추가 옵션으로 영상 스크립트 제공.</div>
          <div class="price">기본 50,000원 ~ (협의)</div>
          <div class="row">
            <button class="btn" onclick="openCommissionForm()">의뢰(시뮬레이션)</button>
            <button class="btn ghost" onclick="showCommissions()">의뢰 현황 보기</button>
          </div>
        </div>

        <div class="product" style="margin-top:10px" id="prodD">
          <strong>Co-Authorship Manager — 공동창작 라이선스 툴</strong>
          <div class="small">현장 수집 텍스트의 저작권 태깅, 버전별 권리행사 기록, 수익 분배 템플릿 제공.</div>
          <div class="price">가격: 월 10,000원 (팀 라이선스)</div>
          <div class="row">
            <button class="btn" onclick="purchase('tool','Co-Authorship Manager',10000)">구매(팀 라이선스 시뮬레이션)</button>
            <button class="btn ghost" onclick="downloadLicenseExample()">라이선스 템플릿 보기</button>
          </div>
        </div>
      </div>

      <!-- Right: admin / demo controls -->
      <div>
        <div class="card" style="padding:12px">
          <h2 style="font-size:1rem">판매 / 주문 관리 (로컬 시뮬레이션)</h2>
          <div class="small" style="margin-top:8px">구매 시뮬레이션은 로컬에 주문을 저장합니다. 실제 결제 연동은 Stripe 등 서버 연동 필요(주석 참조).</div>

          <div style="margin-top:10px">
            <label class="small">구매자 이메일</label>
            <input id="buyerEmail" placeholder="example@domain.com"/>
            <div style="display:flex;gap:8px;margin-top:8px">
              <button class="btn" onclick="simulateBuy()">시뮬레이션 구매 테스트</button>
              <button class="btn ghost" onclick="downloadOrders()">주문 CSV 내보내기</button>
            </div>
          </div>

          <div style="margin-top:12px">
            <div class="small">총 매출 (로컬)</div>
            <div style="margin-top:6px;font-weight:700;color:var(--accent-2)" id="totalSales">0원</div>
            <div style="margin-top:8px">
              <canvas id="salesChart" style="height:160px"></canvas>
            </div>
          </div>
        </div>

        <div class="card" style="margin-top:12px;padding:12px">
          <h2 style="font-size:1rem">도움말 · 운영 가이드</h2>
          <ol class="small" style="padding-left:18px;margin-top:8px">
            <li>상품(디지털)은 PDF로 즉시 제공 가능 — 실제 서비스는 서명된 링크를 권장.</li>
            <li>구독·멤버십은 반복 결제(Stripe/PayPal) 연동으로 안정화.</li>
            <li>커미션은 계약서(라이선스 템플릿)를 통해 권리·보상 규정 명확화.</li>
          </ol>
        </div>
      </div>
    </div>
  </section>

  <!-- Commission modal-like form area (simple) -->
  <section id="commSection" class="card" style="display:none">
    <h2>커미션 접수 (EcoStory Studio)</h2>
    <div class="small">의뢰 접수 폼 (로컬 저장)</div>
    <div style="margin-top:10px;display:grid;gap:8px">
      <input id="cName" placeholder="회사/의뢰자명"/>
      <input id="cEmail" placeholder="연락 이메일"/>
      <select id="cType"><option value="story">지역 서사 제작</option><option value="script">영상 스크립트</option><option value="zine">zine 제작</option></select>
      <textarea id="cDesc" placeholder="요구사항(간단히)"></textarea>
      <div style="display:flex;gap:8px">
        <button class="btn" onclick="submitCommission()">제출</button>
        <button class="btn ghost" onclick="closeCommissionForm()">취소</button>
      </div>
    </div>
  </section>

</main>

<footer>
  <div class="note">데모: 로컬 저장·시뮬레이션 방식입니다. 결제·파일 배포는 별도 서버 연동 권장.</div>
</footer>

<script>
/* -----------------------
   Utilities & storage keys
   ----------------------- */
const KEY_ORDERS = 'econarr_orders';
const KEY_COMMS = 'econarr_comms';
const KEY_SALES = 'econarr_sales';

function saveIfEmpty(){
  if(!localStorage.getItem(KEY_ORDERS)) localStorage.setItem(KEY_ORDERS, JSON.stringify([]));
  if(!localStorage.getItem(KEY_COMMS)) localStorage.setItem(KEY_COMMS, JSON.stringify([]));
  if(!localStorage.getItem(KEY_SALES)) localStorage.setItem(KEY_SALES, JSON.stringify({total:0}));
}
saveIfEmpty();

/* Smooth scroll helper */
function scrollToId(id){
  const el = document.getElementById(id);
  if(!el) return;
  el.scrollIntoView({behavior:'smooth',block:'start'});
}

/* Highlight problems: one-line summary */
function highlightProblems(){
  const box = document.getElementById('summaryBox');
  box.innerText = "요약: 지역적 감각 회복 → 지역 서사 상품화 → 저작권·수익 분배 시스템 필요";
  setTimeout(()=> box.innerText = '', 6000);
}

/* Download idea summary as plain text */
function downloadIdeaSummary(){
  const txt = `해결 아이디어 요약\n\nA. 현장 리서치 키트\nB. Local Eco Zine (구독)\nC. EcoStory Studio (커미션)\nD. Co-Authorship Manager (저작권 도구)\n\n상업화 포인트: 구독/구매/라이선스/기관 판매`;
  const blob = new Blob([txt], {type:'text/plain;charset=utf-8'});
  const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = 'eco_ideas_summary.txt';
  document.body.appendChild(a); a.click(); setTimeout(()=>{a.remove();},500);
}

/* -----------------------
   Purchase / Orders logic
   - purchases are simulated: stored in localStorage
   - PDF generation for digital goods
   ----------------------- */
function getOrders(){ return JSON.parse(localStorage.getItem(KEY_ORDERS) || '[]'); }
function getSales(){ return JSON.parse(localStorage.getItem(KEY_SALES) || '{"total":0}'); }
function saveOrders(arr){ localStorage.setItem(KEY_ORDERS, JSON.stringify(arr)); }
function saveSales(obj){ localStorage.setItem(KEY_SALES, JSON.stringify(obj)); }

function purchase(sku, name, price){
  const buyer = prompt('구매자 이메일을 입력하세요 (시뮬레이션)');
  if(!buyer) return;
  createOrder(sku, name, price, buyer);
  alert('구매(시뮬레이션)가 완료되었습니다. PDF(샘플)는 자동으로 생성됩니다.');
  // generate PDF for digital items
  generatePDF(name + ' — 구매 영수증', `상품: ${name}\n금액: ${price}원\n구매자: ${buyer}\n일시: ${new Date().toLocaleString()}\n\n(샘플 콘텐츠 포함)`);
}

/* Subscription simulation */
function subscribe(sku, name, monthly){
  const buyer = prompt('구독자 이메일을 입력하세요 (시뮬레이션)');
  if(!buyer) return;
  createOrder(sku, name + ' (월구독)', monthly, buyer);
  alert('구독(시뮬레이션) 완료. 첫 달 결제 기록이 저장되었습니다.');
}

/* Create order record */
function createOrder(productId, productName, amount, buyer){
  const orders = getOrders();
  const id = 'ORD' + Date.now();
  orders.push({id, productId, productName, amount:Number(amount), buyer, createdAt:new Date().toISOString()});
  saveOrders(orders);
  // update sales
  const sales = getSales();
  sales.total = (sales.total || 0) + Number(amount);
  saveSales(sales);
  updateSalesUI();
  // auto-download invoice PDF
  generatePDF('영수증_'+id, `주문ID: ${id}\n상품: ${productName}\n금액: ${amount}원\n구매자: ${buyer}\n일시: ${new Date().toLocaleString()}`);
}

/* Simulate a purchase test from right panel */
function simulateBuy(){
  const email = document.getElementById('buyerEmail').value.trim() || prompt('테스트 이메일을 입력하세요');
  if(!email) return;
  createOrder('demo-test','테스트 구매',1000,email);
  alert('테스트 주문이 생성되었습니다.');
}

/* Orders CSV download */
function downloadOrders(){
  const orders = getOrders();
  if(!orders.length) return alert('주문이 없습니다.');
  const header = 'orderId,product,amount,buyer,createdAt\n';
  const rows = orders.map(o => `${o.id},"${o.productName}",${o.amount},${o.buyer},${o.createdAt}`).join('\n');
  const csv = header + rows;
  const a = document.createElement('a'); a.href = URL.createObjectURL(new Blob([csv], {type:'text/csv;charset=utf-8'}));
  a.download = 'orders_'+(new Date()).toISOString().slice(0,10)+'.csv';
  document.body.appendChild(a); a.click(); setTimeout(()=>a.remove(),500);
}

/* -----------------------
   PDF generation (jsPDF)
   ----------------------- */
function generatePDF(title, body){
  try{
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF({unit:'pt',format:'a4'});
    doc.setFontSize(16); doc.text(title, 40, 60);
    doc.setFontSize(11);
    const lines = doc.splitTextToSize(body, 520);
    doc.text(lines, 40, 90);
    const fname = title.replace(/\s+/g,'_').slice(0,40) + '_' + (new Date()).toISOString().slice(0,10) + '.pdf';
    doc.save(fname);
  }catch(e){
    console.error('PDF 생성 실패', e);
    alert('PDF 생성에 실패했습니다.');
  }
}

/* Preview PDF quick */
function previewPDF(title, content){
  generatePDF(title, content);
}

/* -----------------------
   Commission form logic
   ----------------------- */
function openCommissionForm(){
  document.getElementById('commSection').style.display = 'block';
  scrollToId('commSection');
}
function closeCommissionForm(){
  document.getElementById('commSection').style.display = 'none';
}

function submitCommission(){
  const name = document.getElementById('cName').value.trim();
  const email = document.getElementById('cEmail').value.trim();
  const type = document.getElementById('cType').value;
  const desc = document.getElementById('cDesc').value.trim();
  if(!name || !email || !desc) return alert('이름·이메일·요구사항을 입력하세요.');
  const arr = JSON.parse(localStorage.getItem(KEY_COMMS) || '[]');
  const id = 'COM' + Date.now();
  arr.push({id,name,email,type,desc,createdAt:new Date().toISOString(),status:'new'});
  localStorage.setItem(KEY_COMMS, JSON.stringify(arr));
  alert('의뢰가 접수되었습니다. (로컬 저장)');
  closeCommissionForm();
}

/* show commissions (simple) */
function showCommissions(){
  const arr = JSON.parse(localStorage.getItem(KEY_COMMS) || '[]');
  if(!arr.length) return alert('접수된 의뢰가 없습니다.');
  const text = arr.map(a => `ID:${a.id}\n요청자:${a.name}\n타입:${a.type}\n요청:${a.desc}\n---`).join('\n');
  alert(text);
}

/* -----------------------
   License template download
   ----------------------- */
function downloadLicenseExample(){
  const text = `Co-Authorship License (샘플)\n\n- 상업적 사용: 허용\n- 저자 표기: 필수\n- 수익 분배: 기여도 기반(편집자 30%, 기여자 합산 70% 기본안)\n\n(자세한 계약서는 변호사 자문 권장)`;
  const a = document.createElement('a'); a.href = URL.createObjectURL(new Blob([text], {type:'text/plain'}));
  a.download = 'license_template.txt'; document.body.appendChild(a); a.click(); setTimeout(()=>a.remove(),500);
}

/* -----------------------
   Sales UI & chart
   ----------------------- */
function updateSalesUI(){
  const sales = getSales();
  document.getElementById('totalSales').innerText = (sales.total || 0) + '원';
  renderSalesChart();
}
updateSalesUI();

function renderSalesChart(){
  const orders = getOrders();
  // Build simple monthly buckets (last 6 months) from order dates; if none, show zeros
  const labels = []; const values = [];
  for(let i=5;i>=0;i--){
    const d = new Date(); d.setMonth(d.getMonth()-i);
    labels.push(d.toLocaleString('default',{month:'short'}));
  }
  // naive: random-ish demo values or derived from orders
  const monthly = labels.map((lab,idx)=> {
    // compute month offset
    const now = new Date();
    const target = new Date(now.getFullYear(), now.getMonth() - (5-idx), 1);
    const monthOrders = orders.filter(o=>{
      const od = new Date(o.createdAt);
      return od.getFullYear()===target.getFullYear() && od.getMonth()===target.getMonth();
    });
    return monthOrders.reduce((s,m)=> s + (m.amount || 0), 0);
  });

  const ctx = document.getElementById('salesChart').getContext('2d');
  if(window._salesChart) window._salesChart.destroy();
  window._salesChart = new Chart(ctx, {
    type:'bar',
    data:{labels, datasets:[{label:'매출(원)', data: monthly, backgroundColor: '#1f9d8a'}]},
    options:{plugins:{legend:{display:false}}, scales:{y:{beginAtZero:true}}}
  });
}

/* Initialize demo data (optional) */
(function initDemo(){
  // seed small demo if empty
  const orders = getOrders();
  if(orders.length===0){
    // no auto-seed to keep things clean
  }
  updateSalesUI();
})();
</script>

</body>
</html>
